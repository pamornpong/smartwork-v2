<!DOCTYPE html>
<html lang="th">
  <head>
    <meta charset="UTF-8" />
    <title>SMARTWORK – ตั้งค่าระบบ</title>

    <link
      href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <style>
      body {
        font-family: "TH Sarabun New", "Sarabun", sans-serif;
        background: #f0f2f5;
        margin: 0;
        padding: 15px;
      }
      .container {
        max-width: 600px;
        margin: auto;
        background: #fff;
        border-radius: 12px;
        padding: 22px 28px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
      }
      h2 {
        text-align: center;
        font-size: 28px;
        margin-top: 0;
      }
      label {
        font-size: 18px;
        font-weight: 600;
      }
      input,
      select {
        width: 100%;
        padding: 10px;
        margin: 5px 0 12px 0;
        font-size: 18px;
        border-radius: 8px;
        border: 1px solid #bbb;
      }
      button {
        width: 100%;
        padding: 12px;
        font-size: 20px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        margin-top: 10px;
      }
      #saveBtn {
        background: #1e4bb8;
        color: #fff;
      }
      #resetBtn {
        background: #b30000;
        color: #fff;
      }
    </style>
  </head>

  <body>
    <div class="container">
      <h2>ตั้งค่าระบบ (SMARTWORK)</h2>

      <label>ชื่อ - สกุล (ผู้บันทึก)</label>
      <input id="fullname" placeholder="เช่น นายภมรพงศ์ ศักดาวัฒนไพศาล" />

      <label>ตำแหน่ง</label>
      <select id="position">
        <option value="">— เลือกตำแหน่ง —</option>
        <option value="ครู ศกร.">ครู ศกร.</option>
        <option value="นักเทคโนโลยีสารสนเทศ">นักเทคโนโลยีสารสนเทศ</option>
        <option value="นักจัดการงานทั่วไป">นักจัดการงานทั่วไป</option>
        <option value="นักวิชาการเงินและบัญชี">นักวิชาการเงินและบัญชี</option>
        <option value="นักวิเคราะห์นโยบายและแผน">
          นักวิเคราะห์นโยบายและแผน
        </option>
        <option value="นักวิชาการพัสดุ">นักวิชาการพัสดุ</option>
        <option value="บรรณารักษ์">บรรณารักษ์</option>
      </select>

      <label>เลือกอำเภอ (สังกัด)</label>
      <select id="district">
        <option value="">— เลือกอำเภอ —</option>
        <option>เมืองศรีสะเกษ</option>
        <option>ห้วยทับทัน</option>
        <option>ยางชุมน้อย</option>
        <option>กันทรารมย์</option>
        <option>กันทรลักษ์</option>
        <option>ขุขันธ์</option>
        <option>ไพรบึง</option>
        <option>ปรางค์กู่</option>
        <option>ขุนหาญ</option>
        <option>ราษีไศล</option>
        <option>อุทุมพรพิสัย</option>
        <option>ศรีรัตนะ</option>
        <option>น้ำเกลี้ยง</option>
        <option>วังหิน</option>
        <option>ภูสิงห์</option>
        <option>เบญจลักษ์</option>
        <option>พยุห์</option>
        <option>โพธิ์ศรีสุวรรณ</option>
        <option>โนนคูณ</option>
        <option>ศิลาลาด</option>
        <option>เมืองจันทร์</option>
        <option>บึงบูรพ์</option>
      </select>

      <label>เลขที่ ศธ. (Auto)</label>
      <input id="code" disabled />

      <label>ชื่อผู้อำนวยการอำเภอ (Auto)</label>
      <input id="director" disabled />

      <label>ผู้อำนวยการจังหวัด</label>
      <input id="provDirector" value="นายณัฐพงษ์ ทองหล่อ" />

      <button id="saveBtn">บันทึกการตั้งค่า</button>
      <button id="resetBtn">รีเซทระบบ (ต้องใช้ PIN)</button>
    </div>

    <script>
      /* -------- DATA: อำเภอ → ศธ + ผอ. -------- */

      const amphurData = {
        เมืองศรีสะเกษ: {
          code: "07085.01",
          director: "นายวีระพันธ์ อินทรพันธุ์",
        },
        ห้วยทับทัน: { code: "07085.02", director: "นายปัญญา นาคทอง" },
        ยางชุมน้อย: { code: "07085.03", director: "นางจีระพร เสาเวียง" },
        กันทรารมย์: { code: "07085.04", director: "นางสาวลีลาวดี สีหบัณฑ์" },
        กันทรลักษ์: { code: "07085.05", director: "นางวาสนา ชารีวัน" },
        ขุขันธ์: { code: "07085.06", director: "นางบัวทอง บุญสน" },
        ไพรบึง: { code: "07085.07", director: "นางสาวศรีสุดา สุภี" },
        ปรางค์กู่: { code: "07085.08", director: "นางจันทร์ฉาย ทันตา" },
        ขุนหาญ: { code: "07085.09", director: "นางสาวภัสด์หทัย โพธิ์ทอง" },
        ราษีไศล: { code: "07085.10", director: "นายเทวัญ จันทเขต" },
        อุทุมพรพิสัย: { code: "07085.11", director: "นางณัฏฐณิชา รักษาพันธ์" },
        ศรีรัตนะ: { code: "07085.12", director: "นางพัชรีวรรณ สีมาขันธ์" },
        น้ำเกลี้ยง: { code: "07085.13", director: "นางดวงพร เดชวิเศษ" },
        วังหิน: { code: "07085.14", director: "นางสาวพันธิภา ประวาสุข" },
        ภูสิงห์: { code: "07085.15", director: "นางสาวประภาพร สุพรรณ์" },
        เบญจลักษ์: { code: "07085.16", director: "นายวราวุธ ศักดิ์เทวิน" },
        พยุห์: { code: "07085.17", director: "นางสุพักตร์ หนองม่วง" },
        โพธิ์ศรีสุวรรณ: { code: "07085.18", director: "นางสาวกุลธิดา ต้นโสภา" },
        โนนคูณ: {
          code: "07085.19",
          director: "นายพรอาทิตย์ รักษาสิน (รักษาการ)",
        },
        ศิลาลาด: { code: "07085.20", director: "นางสาวอภิญญา ภูมีศรี" },
        เมืองจันทร์: { code: "07085.21", director: "นายอุดมศักดิ์ ศิริบุตร" },
        บึงบูรพ์: { code: "07085.22", director: "นายปิลันธน์ สระแก้ว" },
      };

      /* -------- Auto fill เมื่อเลือกอำเภอ -------- */
      document.getElementById("district").addEventListener("change", () => {
        const d = district.value;
        if (amphurData[d]) {
          code.value = amphurData[d].code;
          director.value = amphurData[d].director;
        } else {
          code.value = "";
          director.value = "";
        }
      });

      /* -------- โหลด config ถ้ามีอยู่แล้ว -------- */
      (function loadConfig() {
        const cfgTxt = localStorage.getItem("SMARTWORK_CONFIG");
        if (!cfgTxt) return;
        const cfg = JSON.parse(cfgTxt);

        fullname.value = cfg.fullname || "";
        position.value = cfg.position || "";
        district.value = cfg.district || "";
        provDirector.value = cfg.provDirector || "นางสาวนฤมล บุตรดี";

        if (cfg.district && amphurData[cfg.district]) {
          code.value = amphurData[cfg.district].code;
          director.value = amphurData[cfg.district].director;
        }
      })();

      /* -------- บันทึกการตั้งค่า -------- */

      document.getElementById("saveBtn").onclick = () => {
        if (!fullname.value || !position.value || !district.value) {
          Swal.fire("ข้อมูลไม่ครบ", "กรุณากรอกข้อมูลให้ครบถ้วน", "warning");
          return;
        }

        const data = {
          fullname: fullname.value.trim(),
          position: position.value,
          district: district.value,
          code: code.value,
          director: director.value,
          provDirector: provDirector.value.trim(),
        };

        localStorage.setItem("SMARTWORK_CONFIG", JSON.stringify(data));

        Swal.fire("บันทึกสำเร็จ", "", "success").then(() => {
          location.href = "form.html";
        });
      };

      /* -------- reset ด้วย PIN -------- */
      document.getElementById("resetBtn").onclick = async () => {
        const { value: pin } = await Swal.fire({
          title: "กรอกรหัส PIN",
          input: "password",
          inputPlaceholder: "ป้อน PIN",
          showCancelButton: true,
        });

        if (!pin) return;

        if (pin !== "212224236248") {
          Swal.fire("PIN ไม่ถูกต้อง", "", "error");
          return;
        }

        localStorage.removeItem("SMARTWORK_CONFIG");
        Swal.fire("รีเซทสำเร็จ", "", "success").then(() => location.reload());
      };
    </script>
  </body>
</html>
